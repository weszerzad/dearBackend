<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event RSVP App</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDKs -->
    <!-- <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script> -->
</head>
<body>
    <div class="container">
        <h1>Event RSVP</h1>
        
        <!-- Form to Add or Update RSVP -->
        <form id="rsvp-form">
            <input type="hidden" id="unique_id">
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" id="name" required>
            </div>

            <div class="form-group">
                <label for="willJoin">Will Join:</label>
                <label>
                    <input type="radio" name="willJoin" value="true" id="joinYes"> Yes
                  </label>
            
                  <label>
                    <input type="radio" name="willJoin" value="false" id="joinNo"> No
                  </label>
                  <label>
                    <input type="radio" name="willJoin" value="undefined" id="joinMaybe"> Unanswered
                  </label>
            </div>

            <div class="form-group">
                <label for="numberOfGuest">Number of Guests:</label>
                <input type="number" id="numberOfGuest" min="0" value="0">
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email">
            </div>
            <div class="form-group">
                <label for="pronoun">Pronoun:</label>
                <!-- <textarea id="pronoun" rows="3"></textarea> -->
                <select id="pronoun" name="pronoun">
                    <option value="Mr.">Mr.</option>
                    <option value="Mrs.">Mrs.</option>
                    <option value="Ms.">Ms.</option>
                </select>
            </div>
            <button type="submit">Submit</button>
            <button type="button" id="cancel-update" class="hidden">Cancel</button>
        </form>

        <div>
            <link rel="preconnect" href="https://fonts.googleapis.com" />
            <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
            <link
              href="https://fonts.googleapis.com/css2?family=Alfa+Slab+One&family=Birthstone&family=Cormorant+Garamond&family=Dancing+Script&family=Great+Vibes&family=Imperial+Script&family=Libre+Bodoni&family=Macondo&family=Montserrat:wght@500&family=Nunito+Sans&family=Satisfy&family=Vujahday+Script&display=swap"
              rel="stylesheet"
            />
            <link rel="preconnect" href="https://fonts.googleapis.com" />
            <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
            <link
              rel="stylesheet"
              href="https://invitera.site/assets/css/bootstrap.css?v=2068466370"
            />
            <style>
              @media (max-width: 768px) {
                #wrapperUndangan .separatorQuotes {
                  display: none;
                }
                #wrapperUndangan .scrollableUndangan {
                  width: 100% !important;
                }
                #scroll-down {
                  display: none;
                }
                #button-open {
                  display: block;
                }
              }
              .open-button {
                display: block;
                margin: 2em auto 0;
                background: #ffffff94;
                border: 0 solid #444;
                padding: 5px 10px;
                border-radius: 15px;
                font-size: 14px;
              }
              .md-modal {
                /* position: fixed; */
                left: 0;
                right: 0;
                width: 50%;
                max-width: 630px;
                min-width: 320px;
                height: auto;
                z-index: 2000;
                visibility: hidden;
                -webkit-backface-visibility: hidden;
                -moz-backface-visibility: hidden;
                backface-visibility: hidden;
              }
              .md-show {
                visibility: visible;
              }
              .md-overlay {
                /* position: fixed; */
                width: 100%;
                height: 100%;
                visibility: hidden;
                top: 0;
                left: 0;
                z-index: 1000;
                opacity: 0;
                background: rgba(228, 240, 227, 0.8);
                -webkit-transition: all 0.3s;
                -moz-transition: all 0.3s;
                transition: all 0.3s;
              }
              .md-show.md-effect-12 ~ .md-overlay {
                background-position: center;
                background-repeat: no-repeat;
                background-size: cover;
              }
              .md-show.md-effect-12 .md-content {
                -webkit-transform: scale(1);
                -moz-transform: scale(1);
                -ms-transform: scale(1);
                transform: scale(1);
                opacity: 1;
              }
              .content-modal {
                /* position: fixed; */
                /* bottom: -900px; */
                position: relative;
                width: 100%;
              }
      
              .sectitle {
                font-family: "Imperial Script", cursive;
              }
              .btnstyle {
                font-family: Montserrat, sans-serif;
              }
              .whitecolor {
                color: #fff;
              }
              .guestcolor {
                color: #bb8a0c;
              }
              .groombridecolor {
                color: #8d181b;
              }
              .pinkcolor {
                color: #e6ac9d;
              }
              @keyframes blink {
                0% {
                  opacity: 1;
                }
                50% {
                  opacity: 0;
                }
                100% {
                  opacity: 1;
                }
              }
              @keyframes fadeInBottom {
                from {
                  opacity: 0;
                  transform: translateY(100%);
                }
                to {
                  opacity: 1;
                }
              }
            </style>
          </div>

        <!-- postcard -->
        <div class="postcard" id="postcard">
            
            <div
        class="md-modal md-effect-12 md-show"
        data-astro-source-file="/Users/phuocpham/Projects/dear/src/pages/index.astro"
        data-astro-source-loc="19:38"
      >
        <div
          class="md-content content-modal"
          data-astro-source-file="/Users/phuocpham/Projects/dear/src/pages/index.astro"
          data-astro-source-loc="20:43"
        >
          <!-- <center
            data-astro-source-file="/Users/phuocpham/Projects/dear/src/pages/index.astro"
            data-astro-source-loc="21:15"
            style="position: absolute; top: 890px; flex: 1; align-self: center; padding-left: 360px;"
          >
            <div class="sectitle whitecolor guestcolor" style="font-size: 2.8rem; margin-bottom: 0; padding-bottom: 0;">
              Dear <span class="guest-pronoun">Mr./Mrs./Ms.</span>
            </div>
            <div
              class="sectitle whitecolor guestcolor guest-name"
              style="font-size: 3.75rem; margin-top: 0; padding-top: 0;"
            >
              Guest Name
            </div>
            <div id="qrcode" style="font-size: 2.8rem; margin-top: 30px; padding: 16px; border-radius: 4px;"></div>
          </center> -->

          <div id="qrcode" style="position: absolute; top: 16px; left: 16px"></div>

          <!-- <button
            class="md-close btnstyle pinkcolor open-button"
            id="fixedbutton"
            data-astro-source-file="/Users/phuocpham/Projects/dear/src/pages/index.astro"
            data-astro-source-loc="33:68"
          >
            OPEN INVITATION
          </button> -->
        </div>
      </div>
      <img id="slider" src="images/IMG_4860.jpg" />
        </div>
        
        <!-- script to generate postcard -->
        <button id="generateButton">Generate Postcard</button>
        <p id="status"></p>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js">
        </script>
        <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
        <script>

            const currentId = localStorage.getItem("currentId");
            console.log(currentId);
            var qrcode = new QRCode(document.getElementById("qrcode"), {
              text: "https://wedding-invite.phuocnghi.live/" + currentId,
              width: 90,
              height: 90,
              colorDark : "#000000",
              colorLight : "#ffffff",
              correctLevel : QRCode.CorrectLevel.H
            })
            document.getElementById('generateButton').addEventListener('click', () => {

                const name = document.getElementById('name').value.trim();
                // const willJoin= document.querySelector('input[name="willJoin"]:checked').value;

                // const numberOfGuest = parseInt(document.getElementById('numberOfGuest').value, 10);
                // const email = document.getElementById('email').value.trim();
                const pronoun = document.getElementById('pronoun').value.trim();

                const nameElements = document.querySelectorAll(".guest-name");
                nameElements.forEach((element) => {
                  element.textContent = name;
                });
                document.querySelectorAll(".guest-pronoun").forEach((element) => {
                  element.textContent = pronoun;
                });

                

                document.getElementById('status').innerText = 'Generating...';
                html2canvas(document.getElementById('postcard')).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    const link = document.createElement('a');
                    link.href = imgData;
                    link.download = 'postcard.png';
                    link.click();
                    document.getElementById('status').innerText = 'Postcard generated successfully!';
                }).catch(error => {
                    console.error('Error generating postcard:', error);
                    document.getElementById('status').innerText = 'Failed to generate postcard.';
                });
            });
        </script>


        <!-- RSVP List -->
        <h2>RSVP List</h2>
        <table>
            <thead>
                <tr>
                    <th>Unique ID</th>
                    <th>Name</th>
                    <th>Will Join</th>
                    <th>Guests</th>
                    <th>Email</th>
                    <th>Pronoun</th>
                    <th>Actions</th>
                    <th>URL</th>
                </tr>
            </thead>
            <tbody id="rsvp-list">
                <!-- Dynamic Content -->
            </tbody>
        </table>
    </div>

    <script type="module" src="app.js"></script>
</body>
</html>
